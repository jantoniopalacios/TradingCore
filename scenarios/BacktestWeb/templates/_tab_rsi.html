<div class="d-flex align-items-center gap-2 mb-3">
    <h2 class="mb-0">Par√°metros de √çndice de Fuerza Relativa (RSI)</h2>
    <button type="button" class="btn btn-outline-info btn-sm" data-bs-toggle="modal" data-bs-target="#rsiInfoModal">
        <i class="bi bi-info-circle"></i> ‚ÑπÔ∏è Ayuda
    </button>
</div>

<!-- Modal con informaci√≥n RSI -->
<div class="modal fade" id="rsiInfoModal" tabindex="-1" aria-labelledby="rsiInfoModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-info text-white">
                <h5 class="modal-title" id="rsiInfoModalLabel">üìà √çndice de Fuerza Relativa (RSI) - Gu√≠a Completa</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p><strong>¬øQu√© es el RSI?</strong> Es un oscilador de momentum que mide la velocidad y magnitud de los cambios de precio en una escala de 0 a 100. Identifica condiciones de sobrecompra (overbought) y sobreventa (oversold).</p>
                
                <h6 class="mt-4 text-dark"><strong>Par√°metros Configurables:</strong></h6>
                <ul class="mb-3">
                    <li><strong>Per√≠odo de C√°lculo:</strong> Por defecto 14. Ventana para calcular ganancias/p√©rdidas promedio.</li>
                    <li><strong>Nivel M√°ximo (Sobrecompra):</strong> Por defecto 70. RSI por encima indica activo "caro" o sobrecalentado.</li>
                    <li><strong>Nivel M√≠nimo (Sobreventa):</strong> Por defecto 30. RSI por debajo indica activo "barato" o sobrecastigado.</li>
                    <li><strong>Umbral de Fuerza:</strong> Por defecto 55. Nivel intermedio para detectar continuaci√≥n alcista sin llegar a sobrecompra.</li>
                </ul>
                
                <h6 class="text-dark"><strong>Se√±ales Disponibles (Activables independientemente):</strong></h6>
                
                <div class="ps-3 border-start border-info">
                    <p class="mb-2"><strong class="text-success">üü¢ COMPRA - L√≥gica OR (cualquiera activa la compra):</strong></p>
                    <ul class="small mb-3">
                        <li><strong>M√≠nimo (Giro desde Sobreventa):</strong> RSI toca valle local (< nivel m√≠nimo) y cruza hacia arriba ‚Üí Rebote despu√©s de sobrecorrecci√≥n.</li>
                        <li><strong>Ascendente:</strong> RSI est√° subiendo ‚Üí Recuperaci√≥n de momentum, entrada en recuperaci√≥n.</li>
                        <li><strong>Fuerza Pura:</strong> RSI > Umbral de Fuerza ‚Üí Continuaci√≥n alcista sin esperar sobreventa (m√°s agresivo).</li>
                    </ul>
                    
                    <p class="mb-2"><strong class="text-danger">üî¥ VENTA / BLOQUEO - L√≥gica AND:</strong></p>
                    <ul class="small mb-3">
                        <li><strong>M√°ximo (Sobrecompra):</strong> RSI toca pico local (> nivel m√°ximo) ‚Üí Realizaci√≥n de ganancias + bloquea nuevas compras.</li>
                        <li><strong>Descendente:</strong> RSI est√° bajando ‚Üí P√©rdida de momentum + bloquea nuevas compras.</li>
                    </ul>
                </div>
                
                <div class="alert alert-warning alert-sm mt-3 mb-3">
                    <strong>üí° Reflexi√≥n sobre M√°ximo + Descendente:</strong><br>
                    <small>Similar a EMA, cuando RSI toca un pico (m√°ximo), la siguiente vela suele estar m√°s baja (descendente). Ambos casi siempre ocurren juntos. Considera usar solo uno para simplificar tu estrategia.</small>
                </div>
                
                <div class="alert alert-success alert-sm mb-3">
                    <strong>‚úÖ Diferencia con EMA (Protecci√≥n Hardcoded):</strong><br>
                    <small>
                        ‚Ä¢ <strong>EMA:</strong> Tiene un <strong>veto hardcoded permanente</strong> ‚Üí Si EMA Lenta est√° descendiendo, BLOQUEA todas las compras sin importar configuraci√≥n.<br>
                        ‚Ä¢ <strong>RSI:</strong> <strong>NO tiene vetos hardcoded</strong> ‚Üí Los bloqueos solo ocurren si T√ö activas los switches "M√°ximo" o "Descendente". Sin ellos, RSI nunca bloquear√° compras por s√≠ solo.
                    </small>
                </div>
                
                <h6 class="text-dark"><strong>Ejemplos de Combinaciones:</strong></h6>
                <ul class="small mb-3">
                    <li><strong>M√≠nimo + M√°ximo:</strong> Estrategia de reversi√≥n cl√°sica ‚Üí Compra en valles, vende en picos.</li>
                    <li><strong>Ascendente solo:</strong> Agresivo ‚Üí Compra cada vez que RSI sube (sin esperar sobreventa).</li>
                    <li><strong>Fuerza Pura (>55) sin bloqueos:</strong> Muy agresivo ‚Üí Sigue la tendencia alcista continuamente.</li>
                    <li><strong>Solo bloqueos sin se√±ales de compra:</strong> ‚ö†Ô∏è Incompatible ‚Üí 0 trades (no hay c√≥mo entrar).</li>
                </ul>
                
                <div class="alert alert-info alert-sm mb-0">
                    <strong>üí° Comportamiento SIN Switches Activados:</strong><br>
                    <small>
                        Si activas RSI PERO no marcas ning√∫n switch (M√≠nimo, Ascendente, M√°ximo, Descendente):<br>
                        ‚Ä¢ <strong>COMPRA:</strong> ‚úÖ S√ç genera se√±ales ‚Üí cuando <code>RSI > Umbral de Fuerza</code> (default 55). Es el modo "Fuerza Pura".<br>
                        ‚Ä¢ <strong>VENTA:</strong> ‚ùå NO genera ventas t√©cnicas ‚Üí solo saldr√° por Stop Loss.<br>
                        ‚Ä¢ <strong>BLOQUEOS:</strong> ‚ùå NO bloquea compras ‚Üí puede entrar incluso en RSI alto.<br>
                        <strong>Resultado:</strong> Estrategia agresiva de seguimiento de tendencia alcista sin protecciones.
                    </small>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-6 border-end">
        <h4 class="mb-3 text-primary">Configuraci√≥n Principal</h4>

        <div class="row row-control align-items-center mb-3">
            <div class="col-6"><label for="rsi" class="form-check-label fw-bold">Activar RSI:</label></div>
            <div class="col-4">
                <div class="form-check form-switch">
                    <input class="form-check-input" type="checkbox" role="switch" id="rsi" name="rsi" value="True" 
                           {% if config.rsi == 'True' %}checked{% endif %}>
                </div>
            </div>
            <div class="col-2">
                <span class="text-muted small">{% if comments.rsi %}<a href="#" title="{{ comments.rsi }}">?</a>{% endif %}</span>
            </div>
        </div>

        <div class="row row-control align-items-center mb-2">
            <div class="col-6"><label for="rsi_period" class="form-label">Per√≠odo de C√°lculo (RSI Period):</label></div>
            <div class="col-4">
                <input type="number" class="form-control" id="rsi_period" name="rsi_period" min="2" value="{{ config.rsi_period }}">
            </div>
            <div class="col-2"><span class="text-muted small">{% if comments.rsi_period %}<a href="#" title="{{ comments.rsi_period }}">?</a>{% endif %}</span></div>
        </div>

        <div class="row row-control align-items-center mb-4">
            <div class="col-6"><label for="rsi_high_level" class="form-label text-danger">Nivel M√°ximo (Sobrecompra):</label></div>
            <div class="col-4">
                <input type="number" class="form-control" id="rsi_high_level" name="rsi_high_level" min="50" max="100" value="{{ config.rsi_high_level }}">
            </div>
            <div class="col-2"><span class="text-muted small">{% if comments.rsi_high_level %}<a href="#" title="{{ comments.rsi_high_level }}">?</a>{% endif %}</span></div>
        </div>
        
        <div class="row row-control align-items-center mb-2">
            <div class="col-6"><label for="rsi_strength_threshold" class="form-label">Umbral de Fuerza:</label></div>
            <div class="col-4">
                <input type="number" class="form-control" id="rsi_strength_threshold" name="rsi_strength_threshold" min="0" max="100" value="{{ config.rsi_strength_threshold }}">
            </div>
            <div class="col-2"><span class="text-muted small">{% if comments.rsi_strength_threshold %}<a href="#" title="{{ comments.rsi_strength_threshold }}">?</a>{% endif %}</span></div>
        </div>
        <p class="text-muted small ms-5">Usado para buscar continuaci√≥n (por encima de este valor).</p>

        <div class="row row-control align-items-center mb-2">
            <div class="col-6"><label for="rsi_low_level" class="form-label text-success">Nivel M√≠nimo (Sobreventa):</label></div>
            <div class="col-4">
                <input type="number" class="form-control" id="rsi_low_level" name="rsi_low_level" min="0" max="50" value="{{ config.rsi_low_level }}">
            </div>
            <div class="col-2"><span class="text-muted small">{% if comments.rsi_low_level %}<a href="#" title="{{ comments.rsi_low_level }}">?</a>{% endif %}</span></div>
        </div>
        <p class="text-muted small ms-5">Usado como filtro de precio 'barato' antes de la ruptura. (Sugerido 40/45).</p>
        <p class="text-muted small ms-5 text-danger">‚ö†Ô∏è Se asume que esta variable es un filtro y NO la condici√≥n principal de Venta (usa 'Overbought').</p>
    </div>

    <div class="col-6">
        <h4 class="mb-3 text-dark">Se√±ales de Compra y Venta</h4>
        <p class="text-muted small">Activa los tipos de se√±al que deseas usar. Ver modal de ayuda para detalles.</p>

        <h5 class="mt-4 text-success">üü¢ Se√±ales de Compra (OR)</h5>
        
        <div class="form-check form-switch mb-3">
            <input class="form-check-input" type="checkbox" id="rsi_minimo" name="rsi_minimo" value="true" 
                   {% if config.get('rsi_minimo') == 'True' or config.get('rsi_minimo') == True %}checked{% endif %}>
            <label class="form-check-label fw-bold" for="rsi_minimo">
                M√≠nimo (Giro desde Sobreventa)
            </label>
        </div>

        <div class="form-check form-switch mb-4">
            <input class="form-check-input" type="checkbox" id="rsi_ascendente" name="rsi_ascendente" value="true" 
                   {% if config.get('rsi_ascendente') == 'True' or config.get('rsi_ascendente') == True %}checked{% endif %}>
            <label class="form-check-label fw-bold" for="rsi_ascendente">
                Ascendente (Recuperaci√≥n)
            </label>
        </div>

        <h5 class="mt-4 text-danger">üî¥ Se√±ales de Venta (OR) / Bloqueos (AND)</h5>
        
        <div class="form-check form-switch mb-3">
            <input class="form-check-input" type="checkbox" id="rsi_maximo" name="rsi_maximo" value="true" 
                   {% if config.get('rsi_maximo') == 'True' or config.get('rsi_maximo') == True %}checked{% endif %}>
            <label class="form-check-label fw-bold" for="rsi_maximo">
                M√°ximo (Sobrecompra)
            </label>
        </div>

        <div class="form-check form-switch mb-4">
            <input class="form-check-input" type="checkbox" id="rsi_descendente" name="rsi_descendente" value="true" 
                   {% if config.get('rsi_descendente') == 'True' or config.get('rsi_descendente') == True %}checked{% endif %}>
            <label class="form-check-label fw-bold" for="rsi_descendente">
                Descendente (P√©rdida Momentum)
            </label>
        </div>
    </div>
</div>